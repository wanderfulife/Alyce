{"remainingRequest":"/Users/j/Desktop/Alyce2.0/Alyce/node_modules/babel-loader/lib/index.js!/Users/j/Desktop/Alyce2.0/Alyce/node_modules/cache-loader/dist/cjs.js??ref--1-0!/Users/j/Desktop/Alyce2.0/Alyce/node_modules/vue-loader-v16/dist/index.js??ref--1-1!/Users/j/Desktop/Alyce2.0/Alyce/src/components/SurveyComponent.vue?vue&type=script&setup=true&lang=js","dependencies":[{"path":"/Users/j/Desktop/Alyce2.0/Alyce/src/components/SurveyComponent.vue","mtime":1704574403514},{"path":"/Users/j/Desktop/Alyce2.0/Alyce/babel.config.js","mtime":1704574265460},{"path":"/Users/j/Desktop/Alyce2.0/Alyce/node_modules/cache-loader/dist/cjs.js","mtime":1704574266976},{"path":"/Users/j/Desktop/Alyce2.0/Alyce/node_modules/babel-loader/lib/index.js","mtime":1704574266904},{"path":"/Users/j/Desktop/Alyce2.0/Alyce/node_modules/cache-loader/dist/cjs.js","mtime":1704574266976},{"path":"/Users/j/Desktop/Alyce2.0/Alyce/node_modules/vue-loader-v16/dist/index.js","mtime":1704574269836}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7CmltcG9ydCB7IHJlZiwgY29tcHV0ZWQsIHdhdGNoIH0gZnJvbSAidnVlIjsKaW1wb3J0IHsgcG9zdGVzLCBwbGFxdWVzLCB0eXBlVmVoaWN1bGUsIG9jY3VwYXRpb24gfSBmcm9tICIuL3JlcG9uc2VzIjsKaW1wb3J0IGluc2VlIGZyb20gIi4vb3V0cHV0Lmpzb24iOwppbXBvcnQgeyBkYiB9IGZyb20gIi4uL2ZpcmViYXNlQ29uZmlnIjsKaW1wb3J0ICogYXMgWExTWCBmcm9tICJ4bHN4IjsKaW1wb3J0IHsgY29sbGVjdGlvbiwgYWRkRG9jLCBnZXREb2NzIH0gZnJvbSAiZmlyZWJhc2UvZmlyZXN0b3JlIjsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdTdXJ2ZXlDb21wb25lbnQnLAogIHNldHVwKF9fcHJvcHMsIHsKICAgIGV4cG9zZQogIH0pIHsKICAgIGV4cG9zZSgpOwogICAgY29uc3QgZGF0YSA9IHJlZihpbnNlZSk7CiAgICBjb25zdCBzdXJ2ZXlDb2xsZWN0aW9uUmVmID0gY29sbGVjdGlvbihkYiwgIkNhZW4iKTsKICAgIGNvbnN0IG51bSA9IHJlZigxKTsKICAgIGNvbnN0IHJlcG9uc2UgPSByZWYoewogICAgICBwb3N0ZTogIiIsCiAgICAgIHBsYXF1ZTogIiIsCiAgICAgIHR5cGU6ICIiLAogICAgICBudW06IG51bS52YWx1ZSwKICAgICAgb2NjdXBhdGlvbjogIiIsCiAgICAgIG9yaWdpbmU6ICIiCiAgICB9KTsKICAgIGNvbnN0IHNob3dTZWNvbmRTZXQgPSByZWYoZmFsc2UpOwogICAgY29uc3Qgc2hvd1N1Ym1pdEJ1dHRvbiA9IHJlZihmYWxzZSk7CiAgICBjb25zdCBzaG93UmV0dXJuQnV0dG9uID0gcmVmKGZhbHNlKTsKICAgIGNvbnN0IHNob3dEcm9wZG93biA9IHJlZih0cnVlKTsKICAgIGNvbnN0IHNlbGVjdENvbW11bmUgPSAoY29tbXVuZTEsIGNvbW11bmUyKSA9PiB7CiAgICAgIHJlcG9uc2UudmFsdWUub3JpZ2luZSA9IGNvbW11bmUxICsgJy0nICsgY29tbXVuZTI7CiAgICAgIHNob3dEcm9wZG93bi52YWx1ZSA9IGZhbHNlOyAvLyBIaWRlIHRoZSBkcm9wZG93bgogICAgfTsKCiAgICAvLyBUbyBzaG93IHRoZSBkcm9wZG93biBhZ2FpbiB3aGVuIHRoZSB1c2VyIHR5cGVzCiAgICB3YXRjaCgoKSA9PiByZXBvbnNlLnZhbHVlLm9yaWdpbmUsIG5ld1ZhbHVlID0+IHsKICAgICAgc2hvd0Ryb3Bkb3duLnZhbHVlID0gQm9vbGVhbihuZXdWYWx1ZSk7CiAgICB9KTsKICAgIHdhdGNoKCgpID0+IFtyZXBvbnNlLnZhbHVlLnBvc3RlLCByZXBvbnNlLnZhbHVlLnBsYXF1ZSwgcmVwb25zZS52YWx1ZS50eXBlLCByZXBvbnNlLnZhbHVlLm9jY3VwYXRpb25dLCAoW3Bvc3RlLCBwbGFxdWUsIHR5cGVdKSA9PiB7CiAgICAgIGlmIChwb3N0ZSAhPT0gIiIgJiYgcGxhcXVlICE9PSAiIiAmJiB0eXBlICE9PSAiIikgewogICAgICAgIHNob3dTZWNvbmRTZXQudmFsdWUgPSB0cnVlOwogICAgICAgIHNob3dTdWJtaXRCdXR0b24udmFsdWUgPSB0cnVlOwogICAgICAgIHNob3dSZXR1cm5CdXR0b24udmFsdWUgPSB0cnVlOwogICAgICB9IGVsc2UgewogICAgICAgIHNob3dTZWNvbmRTZXQudmFsdWUgPSBmYWxzZTsKICAgICAgICBzaG93U3VibWl0QnV0dG9uLnZhbHVlID0gZmFsc2U7CiAgICAgICAgc2hvd1JldHVybkJ1dHRvbi52YWx1ZSA9IGZhbHNlOwogICAgICB9CiAgICB9KTsKICAgIGNvbnN0IGZpbHRlcmVkQ29tbXVuZXMgPSBjb21wdXRlZCgoKSA9PiB7CiAgICAgIHJldHVybiBkYXRhLnZhbHVlLmZpbHRlcihpdGVtID0+IGl0ZW0uQ09NTVVORS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHJlcG9uc2UudmFsdWUub3JpZ2luZS50b0xvd2VyQ2FzZSgpKSk7CiAgICB9KTsKICAgIGNvbnN0IHJldHVybkJ1dHRvbiA9ICgpID0+IHsKICAgICAgcmVwb25zZS52YWx1ZS50eXBlID0gIiI7CiAgICB9OwogICAgY29uc3QgaXNTdWJtaXREaXNhYmxlZCA9IGNvbXB1dGVkKCgpID0+IHsKICAgICAgcmV0dXJuIHJlcG9uc2UudmFsdWUucG9zdGUgPT09ICIiIHx8IHJlcG9uc2UudmFsdWUucGxhcXVlID09PSAiIiB8fCByZXBvbnNlLnZhbHVlLnR5cGUgPT09ICIiOwogICAgfSk7CiAgICBjb25zdCBzdWJtaXRTdXJ2ZXkgPSBhc3luYyAoKSA9PiB7CiAgICAgIGF3YWl0IGFkZERvYyhzdXJ2ZXlDb2xsZWN0aW9uUmVmLCB7CiAgICAgICAgcTE6IHJlcG9uc2UudmFsdWUucG9zdGUsCiAgICAgICAgcTI6IG5ldyBEYXRlKCkudG9Mb2NhbGVEYXRlU3RyaW5nKCJmci1GUiIpLnJlcGxhY2UoL1wvL2csICItIiksCiAgICAgICAgcTQ6IHJlcG9uc2UudmFsdWUubnVtLAogICAgICAgIHE1OiBuZXcgRGF0ZSgpLnRvTG9jYWxlVGltZVN0cmluZygiZnItRlIiKS5zbGljZSgwLCA4KSwKICAgICAgICBxNjogcmVwb25zZS52YWx1ZS5wbGFxdWUsCiAgICAgICAgcTc6IHJlcG9uc2UudmFsdWUudHlwZSwKICAgICAgICBxODogcmVwb25zZS52YWx1ZS5vY2N1cGF0aW9uLAogICAgICAgIHE5OiByZXBvbnNlLnZhbHVlLm9yaWdpbmUKICAgICAgfSk7CiAgICAgIHJlcG9uc2UudmFsdWUubnVtKys7CiAgICAgIHJlcG9uc2UudmFsdWUucG9zdGUgPSAiIjsKICAgICAgcmVwb25zZS52YWx1ZS5wbGFxdWUgPSAiIjsKICAgICAgcmVwb25zZS52YWx1ZS50eXBlID0gIiI7CiAgICAgIHJlcG9uc2UudmFsdWUub2NjdXBhdGlvbiA9ICIiOwogICAgICByZXBvbnNlLnZhbHVlLm9yaWdpbmUgPSAiIjsKICAgIH07CiAgICBjb25zdCBkb3dubG9hZERhdGEgPSBhc3luYyAoKSA9PiB7CiAgICAgIHRyeSB7CiAgICAgICAgY29uc3QgcXVlcnlTbmFwc2hvdCA9IGF3YWl0IGdldERvY3Moc3VydmV5Q29sbGVjdGlvblJlZik7CiAgICAgICAgbGV0IGRhdGEgPSBbXTsKICAgICAgICBsZXQgbWF4V2lkdGhzID0ge307IC8vIE9iamVjdCB0byBrZWVwIHRyYWNrIG9mIG1heGltdW0gd2lkdGggZm9yIGVhY2ggY29sdW1uCiAgICAgICAgY29uc3QgbWluV2lkdGggPSAxOyAvLyBNaW5pbXVtIHdpZHRoIGluIEV4Y2VsIHVuaXRzLCBhcHByb3hpbWF0ZWx5IDMgY20KCiAgICAgICAgcXVlcnlTbmFwc2hvdC5mb3JFYWNoKGRvYyA9PiB7CiAgICAgICAgICBsZXQgZG9jRGF0YSA9IGRvYy5kYXRhKCk7CiAgICAgICAgICBsZXQgbWFwcGVkRGF0YSA9IHsKICAgICAgICAgICAgcTE6IGRvY0RhdGEucTEgfHwgIiIsCiAgICAgICAgICAgIHEyOiBkb2NEYXRhLnEyIHx8ICIiLAogICAgICAgICAgICBxMzogZG9jLmlkLAogICAgICAgICAgICAvLyBGaXJlYmFzZSBkb2N1bWVudCBJRAogICAgICAgICAgICBxNDogZG9jRGF0YS5xNCB8fCAiIiwKICAgICAgICAgICAgcTU6IGRvY0RhdGEucTUgfHwgIiIsCiAgICAgICAgICAgIHE2OiBkb2NEYXRhLnE2IHx8ICIiLAogICAgICAgICAgICBxNzogZG9jRGF0YS5xNyB8fCAiIiwKICAgICAgICAgICAgcTg6IGRvY0RhdGEucTggfHwgIiIsCiAgICAgICAgICAgIHE5OiBkb2NEYXRhLnE5IHx8ICIiCiAgICAgICAgICB9OwogICAgICAgICAgZGF0YS5wdXNoKG1hcHBlZERhdGEpOwogICAgICAgIH0pOwoKICAgICAgICAvLyBTb3J0IGRhdGEgYnkgJ051bWVyb19FbnF1ZXRlJyAoRmlyZWJhc2UgZG9jdW1lbnQgSUQpCiAgICAgICAgZGF0YS5zb3J0KChhLCBiKSA9PiBOdW1iZXIoYS5OdW1lcm9fcXVlc3Rpb25uYWlyZSkgLSBOdW1iZXIoYi5OdW1lcm9fcXVlc3Rpb25uYWlyZSkpOwoKICAgICAgICAvLyBDYWxjdWxhdGUgdGhlIG1heGltdW0gd2lkdGggZm9yIGVhY2ggY29sdW1uLCBjb25zaWRlcmluZyB0aGUgbWluaW11bSB3aWR0aAogICAgICAgIGNvbnN0IHNjYWxpbmdGYWN0b3IgPSAxLjI7IC8vIEFkanVzdCB0aGlzIGZhY3RvciBhcyBuZWVkZWQgZm9yIHBhZGRpbmcgb3Igd2lkZXIgY2hhcmFjdGVycwoKICAgICAgICBPYmplY3Qua2V5cyhkYXRhWzBdKS5mb3JFYWNoKGtleSA9PiB7CiAgICAgICAgICBsZXQgbWF4TGVuID0gTWF0aC5tYXgoLi4uZGF0YS5tYXAoaXRlbSA9PiBpdGVtW2tleV0udG9TdHJpbmcoKS5sZW5ndGgpLCBtaW5XaWR0aCk7CiAgICAgICAgICBtYXhXaWR0aHNba2V5XSA9IE1hdGguY2VpbChtYXhMZW4gKiBzY2FsaW5nRmFjdG9yKTsgLy8gQXBwbHkgc2NhbGluZyBmYWN0b3IgYW5kIHJvdW5kIHVwCiAgICAgICAgfSk7CgogICAgICAgIC8vIE9iamVjdC5rZXlzKGRhdGFbMF0pLmZvckVhY2goKGtleSkgPT4gewogICAgICAgIC8vICAgbGV0IG1heExlbiA9IE1hdGgubWF4KAogICAgICAgIC8vICAgICAuLi5kYXRhLm1hcCgoaXRlbSkgPT4gaXRlbVtrZXldLnRvU3RyaW5nKCkubGVuZ3RoKSwKICAgICAgICAvLyAgICAgbWluV2lkdGgKICAgICAgICAvLyAgICk7CiAgICAgICAgLy8gICBtYXhXaWR0aHNba2V5XSA9IG1heExlbjsKICAgICAgICAvLyB9KTsKCiAgICAgICAgLy8gQ29udmVydCBkYXRhIHRvIGEgd29ya3NoZWV0CiAgICAgICAgY29uc3Qgd29ya3NoZWV0ID0gWExTWC51dGlscy5qc29uX3RvX3NoZWV0KGRhdGEsIHsKICAgICAgICAgIGhlYWRlcjogWyJQb3N0ZSIsICJEYXRlIiwgIk51bWVyb19FbnF1ZXRlIiwgIk51bWVyb19xdWVzdGlvbm5haXJlIiwgImhldXJlIiwgInE2IiwgInE3IiwgInE4IiwgInE5Il0sCiAgICAgICAgICBza2lwSGVhZGVyOiBmYWxzZQogICAgICAgIH0pOwoKICAgICAgICAvLyBTZXQgdGhlIHdpZHRocyBmb3IgZWFjaCBjb2x1bW4sIGVuc3VyaW5nIGEgbWluaW11bSB3aWR0aAogICAgICAgIHdvcmtzaGVldFsiIWNvbHMiXSA9IE9iamVjdC5rZXlzKG1heFdpZHRocykubWFwKGtleSA9PiAoewogICAgICAgICAgd2NoOiBtYXhXaWR0aHNba2V5XQogICAgICAgIH0pKTsKICAgICAgICBjb25zdCB3b3JrYm9vayA9IFhMU1gudXRpbHMuYm9va19uZXcoKTsKICAgICAgICBYTFNYLnV0aWxzLmJvb2tfYXBwZW5kX3NoZWV0KHdvcmtib29rLCB3b3Jrc2hlZXQsICJEYXRhIik7CgogICAgICAgIC8vIEV4cG9ydCB0aGUgd29ya2Jvb2sgdG8gYSAueGxzeCBmaWxlCiAgICAgICAgWExTWC53cml0ZUZpbGUod29ya2Jvb2ssICJPZENhZW4ueGxzeCIpOwogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoIkVycm9yIGRvd25sb2FkaW5nIGRhdGE6ICIsIGVycm9yKTsKICAgICAgfQogICAgfTsKICAgIGNvbnN0IF9fcmV0dXJuZWRfXyA9IHsKICAgICAgZGF0YSwKICAgICAgc3VydmV5Q29sbGVjdGlvblJlZiwKICAgICAgbnVtLAogICAgICByZXBvbnNlLAogICAgICBzaG93U2Vjb25kU2V0LAogICAgICBzaG93U3VibWl0QnV0dG9uLAogICAgICBzaG93UmV0dXJuQnV0dG9uLAogICAgICBzaG93RHJvcGRvd24sCiAgICAgIHNlbGVjdENvbW11bmUsCiAgICAgIGZpbHRlcmVkQ29tbXVuZXMsCiAgICAgIHJldHVybkJ1dHRvbiwKICAgICAgaXNTdWJtaXREaXNhYmxlZCwKICAgICAgc3VibWl0U3VydmV5LAogICAgICBkb3dubG9hZERhdGEsCiAgICAgIHJlZiwKICAgICAgY29tcHV0ZWQsCiAgICAgIHdhdGNoLAogICAgICBwb3N0ZXMsCiAgICAgIHBsYXF1ZXMsCiAgICAgIHR5cGVWZWhpY3VsZSwKICAgICAgb2NjdXBhdGlvbiwKICAgICAgaW5zZWUsCiAgICAgIGRiLAogICAgICBYTFNYLAogICAgICBjb2xsZWN0aW9uLAogICAgICBhZGREb2MsCiAgICAgIGdldERvY3MKICAgIH07CiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoX19yZXR1cm5lZF9fLCAnX19pc1NjcmlwdFNldHVwJywgewogICAgICBlbnVtZXJhYmxlOiBmYWxzZSwKICAgICAgdmFsdWU6IHRydWUKICAgIH0pOwogICAgcmV0dXJuIF9fcmV0dXJuZWRfXzsKICB9Cn07"},{"version":3,"names":["ref","computed","watch","postes","plaques","typeVehicule","occupation","insee","db","XLSX","collection","addDoc","getDocs","data","surveyCollectionRef","num","reponse","poste","plaque","type","value","origine","showSecondSet","showSubmitButton","showReturnButton","showDropdown","selectCommune","commune1","commune2","newValue","Boolean","filteredCommunes","filter","item","COMMUNE","toLowerCase","includes","returnButton","isSubmitDisabled","submitSurvey","q1","q2","Date","toLocaleDateString","replace","q4","q5","toLocaleTimeString","slice","q6","q7","q8","q9","downloadData","querySnapshot","maxWidths","minWidth","forEach","doc","docData","mappedData","q3","id","push","sort","a","b","Number","Numero_questionnaire","scalingFactor","Object","keys","key","maxLen","Math","max","map","toString","length","ceil","worksheet","utils","json_to_sheet","header","skipHeader","wch","workbook","book_new","book_append_sheet","writeFile","error","console"],"sources":["/Users/j/Desktop/Alyce2.0/Alyce/src/components/SurveyComponent.vue"],"sourcesContent":["<template>\n  <div class=\"container\">\n    <h1>OD Caen</h1>\n    <form @submit.prevent=\"submitSurvey\">\n      <div v-if=\"!showSecondSet\">\n        <div class=\"form-group\">\n          <label for=\"poste\">Poste</label>\n          <select id=\"poste\" v-model=\"reponse.poste\" class=\"form-control\">\n            <option v-for=\"option in postes\" :key=\"option.id\" :value=\"option.output\">\n              {{ option.text }}\n            </option>\n          </select>\n        </div>\n\n        <div class=\"form-group\">\n          <label for=\"plaque\">Code Pays (immatriculation du véhicule plaque à l'avant):</label>\n          <select id=\"plaque\" v-model=\"reponse.plaque\" class=\"form-control\">\n            <option v-for=\"option in plaques\" :key=\"option.id\" :value=\"option.output\">\n              {{ option.text }}\n            </option>\n          </select>\n        </div>\n\n        <div class=\"form-group\">\n          <label for=\"type\">Type de véhicule:</label>\n          <select id=\"type\" v-model=\"reponse.type\" class=\"form-control\">\n            <option v-for=\"option in typeVehicule\" :key=\"option.id\" :value=\"option.output\">\n              {{ option.text }}\n            </option>\n          </select>\n        </div>\n      </div>\n\n      <div v-else>\n        <div v-if=\"reponse.type <= 4\">\n\n          <div class=\"form-group\">\n            <input class=\"form-control\" type=\"text\" v-model=\"reponse.origine\"\n              placeholder=\"Entrer les premiere lettres de la COMMUNE\" />\n            <ul v-if=\"showDropdown && reponse.origine && filteredCommunes.length\" class=\"commune-dropdown\">\n              <li v-for=\"(item, index) in filteredCommunes\" :key=\"`${item['CODE INSEE']}-${index}`\"\n                @click=\"selectCommune(item.COMMUNE, item.DEPARTEMENT)\">\n                {{item.COMMUNE }} - {{ item.DEPARTEMENT }}\n              </li>\n            </ul>\n          </div>\n\n          <div class=\"form-group\">\n            <label for=\"type\">Nombre d'occupants:</label>\n            <select id=\"type\" v-model=\"reponse.occupation\" class=\"form-control\">\n              <option v-for=\"option in occupation\" :key=\"option.id\" :value=\"option.output\">\n                {{ option.text }}\n              </option>\n            </select>\n          </div>\n        </div>\n        <div v-else-if=\"reponse.occupation > 4\">PL</div>\n      </div>\n      <button v-show=\"showReturnButton\" type=\"button\" @click=\"returnButton\" class=\"btn-return\">\n        Return to First Set\n      </button>\n      <input v-show=\"showSubmitButton\" type=\"submit\" value=\"Submit\" class=\"btn-submit\" :disabled=\"isSubmitDisabled\" />\n    </form>\n  </div>\n  <button @click=\"downloadData\" class=\"btn-data\">Download Data</button>\n</template>\n\n<script setup>\nimport { ref, computed, watch } from \"vue\";\nimport { postes, plaques, typeVehicule, occupation } from \"./reponses\";\nimport insee from \"./output.json\";\nimport { db } from \"../firebaseConfig\";\nimport * as XLSX from \"xlsx\";\nimport { collection, addDoc, getDocs } from \"firebase/firestore\";\n\nconst data = ref(insee);\n\nconst surveyCollectionRef = collection(db, \"Caen\");\nconst num = ref(1);\nconst reponse = ref({\n  poste: \"\",\n  plaque: \"\",\n  type: \"\",\n  num: num.value,\n  occupation: \"\",\n  origine: \"\",\n});\n\nconst showSecondSet = ref(false);\nconst showSubmitButton = ref(false);\nconst showReturnButton = ref(false);\n\nconst showDropdown = ref(true);\n\nconst selectCommune = (commune1, commune2) => {\n  reponse.value.origine = commune1 + '-' + commune2;\n  showDropdown.value = false; // Hide the dropdown\n};\n\n// To show the dropdown again when the user types\nwatch(() => reponse.value.origine, (newValue) => {\n  showDropdown.value = Boolean(newValue);\n});\n\nwatch(\n  () => [\n    reponse.value.poste,\n    reponse.value.plaque,\n    reponse.value.type,\n    reponse.value.occupation,\n  ],\n  ([poste, plaque, type]) => {\n    if (poste !== \"\" && plaque !== \"\" && type !== \"\") {\n      showSecondSet.value = true;\n      showSubmitButton.value = true;\n      showReturnButton.value = true;\n    } else {\n      showSecondSet.value = false;\n      showSubmitButton.value = false;\n      showReturnButton.value = false;\n    }\n  }\n);\n\n\nconst filteredCommunes = computed(() => {\n  return data.value.filter(item =>\n    item.COMMUNE.toLowerCase().includes(reponse.value.origine.toLowerCase())\n  );\n});\n\n\n\n\nconst returnButton = () => {\n  reponse.value.type = \"\";\n};\n\nconst isSubmitDisabled = computed(() => {\n  return (\n    reponse.value.poste === \"\" ||\n    reponse.value.plaque === \"\" ||\n    reponse.value.type === \"\"\n  );\n});\n\nconst submitSurvey = async () => {\n  await addDoc(surveyCollectionRef, {\n    q1: reponse.value.poste,\n    q2: new Date().toLocaleDateString(\"fr-FR\").replace(/\\//g, \"-\"),\n    q4: reponse.value.num,\n    q5: new Date().toLocaleTimeString(\"fr-FR\").slice(0, 8),\n    q6: reponse.value.plaque,\n    q7: reponse.value.type,\n    q8: reponse.value.occupation,\n    q9: reponse.value.origine,\n  });\n  reponse.value.num++;\n  reponse.value.poste = \"\";\n  reponse.value.plaque = \"\";\n  reponse.value.type = \"\";\n  reponse.value.occupation = \"\";\n  reponse.value.origine = \"\";\n};\n\nconst downloadData = async () => {\n  try {\n    const querySnapshot = await getDocs(surveyCollectionRef);\n    let data = [];\n    let maxWidths = {}; // Object to keep track of maximum width for each column\n    const minWidth = 1; // Minimum width in Excel units, approximately 3 cm\n\n    querySnapshot.forEach((doc) => {\n      let docData = doc.data();\n      let mappedData = {\n        q1: docData.q1 || \"\",\n        q2: docData.q2 || \"\",\n        q3: doc.id, // Firebase document ID\n        q4: docData.q4 || \"\",\n        q5: docData.q5 || \"\",\n        q6: docData.q6 || \"\",\n        q7: docData.q7 || \"\",\n        q8: docData.q8 || \"\",\n        q9: docData.q9 || \"\",\n      };\n      data.push(mappedData);\n    });\n\n    // Sort data by 'Numero_Enquete' (Firebase document ID)\n    data.sort(\n      (a, b) => Number(a.Numero_questionnaire) - Number(b.Numero_questionnaire)\n    );\n\n\n    // Calculate the maximum width for each column, considering the minimum width\n    const scalingFactor = 1.2; // Adjust this factor as needed for padding or wider characters\n\nObject.keys(data[0]).forEach((key) => {\n  let maxLen = Math.max(\n    ...data.map((item) => item[key].toString().length),\n    minWidth\n  );\n\n  maxWidths[key] = Math.ceil(maxLen * scalingFactor); // Apply scaling factor and round up\n});\n\n    // Object.keys(data[0]).forEach((key) => {\n    //   let maxLen = Math.max(\n    //     ...data.map((item) => item[key].toString().length),\n    //     minWidth\n    //   );\n    //   maxWidths[key] = maxLen;\n    // });\n\n    // Convert data to a worksheet\n    const worksheet = XLSX.utils.json_to_sheet(data, {\n      header: [\n        \"Poste\",\n        \"Date\",\n        \"Numero_Enquete\",\n        \"Numero_questionnaire\",\n        \"heure\",\n        \"q6\",\n        \"q7\",\n        \"q8\",\n        \"q9\",\n      ],\n      skipHeader: false,\n    });\n\n    // Set the widths for each column, ensuring a minimum width\n    worksheet[\"!cols\"] = Object.keys(maxWidths).map((key) => ({\n      wch: maxWidths[key],\n    }));\n\n    const workbook = XLSX.utils.book_new();\n    XLSX.utils.book_append_sheet(workbook, worksheet, \"Data\");\n\n    // Export the workbook to a .xlsx file\n    XLSX.writeFile(workbook, \"OdCaen.xlsx\");\n  } catch (error) {\n    console.error(\"Error downloading data: \", error);\n  }\n};\n</script>\n\n<style>\nbody {\n  background-color: #1e1e1e;\n}\n\n.container {\n  background-color: #1e1e1e;\n  color: white;\n  padding: 20px;\n  border-radius: 10px;\n  width: 300px;\n  margin: auto;\n}\n\n.form-group {\n  margin-bottom: 15px;\n}\n\nlabel {\n  display: block;\n  margin-bottom: 5px;\n}\n\n.form-control {\n  width: 100%;\n  padding: 10px;\n  border-radius: 5px;\n  border: 1px solid #333;\n  background-color: #333;\n  color: white;\n  text-transform: uppercase;\n}\n\n.btn-submit {\n  background-color: #4caf50;\n  color: white;\n  padding: 10px 20px;\n  border: none;\n  border-radius: 5px;\n  cursor: pointer;\n  width: 100%;\n}\n.btn-return {\n  background-color: #4caf50;\n  color: white;\n  padding: 10px 20px;\n  margin: 10px 0;\n  border: none;\n  border-radius: 5px;\n  cursor: pointer;\n  width: 100%;\n}\n\n.btn-submit:hover {\n  background-color: #45a049;\n}\n.btn-return:hover {\n  background-color: #45a049;\n}\n\n.btn-data {\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  background-color: #4caf50;\n  color: white;\n  padding: 10px 20px;\n  border: none;\n  border-radius: 5px;\n  cursor: pointer;\n  width: 100%;\n}\n\n.btn-data:hover {\n  background-color: #45a049;\n}\n\nh1 {\n  text-align: center;\n  color: #4caf50;\n}\n\n.commune-dropdown {\n  /* Style your dropdown list here */\n  list-style-type: none;\n  padding: 0;\n  margin: 0;\n  border: 1px solid #ccc;\n  border-radius: 4px;\n  max-height: 200px;\n  overflow-y: auto;\n}\n\n.commune-dropdown li {\n  padding: 5px 10px;\n  cursor: pointer;\n}\n\n.commune-dropdown li:hover {\n  background-color: #f0f0f0;\n}\n</style>\n"],"mappings":"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"}]}